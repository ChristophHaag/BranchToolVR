<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>imebra: changeTransferSyntax/changeTransferSyntax.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">imebra
   &#160;<span id="projectnumber">2015 build 20160119-002</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="pages.html"><span>User&#160;manual</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('change_transfer_syntax_2change_transfer_syntax_8cpp-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">changeTransferSyntax/changeTransferSyntax.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>This application reads a dicom file and writes it back to disk using a different transfer syntax.</p>
<p><b>Usage</b> </p>
<div class="fragment"><div class="line">changeTransferSyntax originalDicomFile outputDicomFile transferSyntaxEnum</div>
</div><!-- fragment --><ul>
<li>originalDicomFile: the name of the dicom file to be converted</li>
<li>outputDicomFile: the name of the generated dicom file</li>
<li>transferSyntaxEnum: the id of the transfer syntax used to generate the dicom file<br/>
 The possible values are:<ul>
<li>0 = Explicit VR little endian</li>
<li>1 = Explicit VR big endian</li>
<li>2 = RLE compression</li>
<li>3 = Jpeg baseline (8 bits lossy)</li>
<li>4 = Jpeg extended (12 bits lossy)</li>
<li>5 = Jpeg lossless NH</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Imebra 2015 build 20160119-002</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Imebra: a C++ Dicom library</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Copyright (c) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015</span></div>
<div class="line"><span class="comment">by Paolo Brandoli/Binarno s.p.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">All rights reserved.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> it under the terms of the GNU General Public License version 2 as published by</span></div>
<div class="line"><span class="comment"> the Free Software Foundation.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> GNU General Public License for more details.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment"> along with this program; if not, write to the Free Software</span></div>
<div class="line"><span class="comment"> Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">-------------------</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">If you want to use Imebra commercially then you have to buy the commercial</span></div>
<div class="line"><span class="comment"> license available at http://imebra.com</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">After you buy the commercial license then you can use Imebra according</span></div>
<div class="line"><span class="comment"> to the terms described in the Imebra Commercial License Version 2.</span></div>
<div class="line"><span class="comment">A copy of the Imebra Commercial License Version 2 is available in the</span></div>
<div class="line"><span class="comment"> documentation pages.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">Imebra is available at http://imebra.com</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">The author can be contacted by email at info@binarno.com or by mail at</span></div>
<div class="line"><span class="comment"> the following address:</span></div>
<div class="line"><span class="comment"> Binarno s.p., Paolo Brandoli</span></div>
<div class="line"><span class="comment"> Rakuseva 14</span></div>
<div class="line"><span class="comment"> 1000 Ljubljana</span></div>
<div class="line"><span class="comment"> Slovenia</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;../../library/imebra/include/imebra.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef PUNTOEXE_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#include &lt;process.h&gt;</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#include &lt;spawn.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/wait.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>puntoexe;</div>
<div class="line"><span class="keyword">using namespace </span>puntoexe::imebra;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> findArgument(<span class="keyword">const</span> <span class="keywordtype">char</span>* argument, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> scanArg(0); scanArg != argc; ++scanArg)</div>
<div class="line">        {</div>
<div class="line">                <span class="keywordflow">if</span>(std::string(argv[scanArg]) == argument)</div>
<div class="line">                {</div>
<div class="line">                        <span class="keywordflow">return</span> scanArg;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> CopyGroups(<a name="_a0"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataSet&gt;</a> source, <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataSet&gt;</a> destination)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordflow">for</span>(<a class="code" href="classpuntoexe_1_1ptr.html">ptr</a>&lt;<a name="_a1"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_collection_iterator.html">dataCollectionIterator&lt;dataGroup&gt;</a> &gt; scanGroups(source-&gt;<a name="a2"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_collection.html#ad3053b8aa90c85a698215c5d733b437d">getDataIterator</a>()); scanGroups-&gt;<a name="a3"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_collection_iterator.html#a3c80909070bc95735155ef830f7a3314">isValid</a>(); scanGroups-&gt;incIterator())</div>
<div class="line">        {</div>
<div class="line">                <a name="_a4"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataGroup&gt;</a> sourceGroup(scanGroups-&gt;getData());</div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataGroup&gt;</a> newGroup(destination-&gt;<a name="a5"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_set.html#aade0dad9ea4df64c7429784fa458b956">getGroup</a>(scanGroups-&gt;getId(), scanGroups-&gt;getOrder(), <span class="keyword">true</span>));</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span>(<a class="code" href="classpuntoexe_1_1ptr.html">ptr</a>&lt;<a class="code" href="classpuntoexe_1_1imebra_1_1data_collection_iterator.html">dataCollectionIterator&lt;imebra::data&gt;</a> &gt; scanTags(sourceGroup-&gt;getDataIterator()); scanTags-&gt;<a class="code" href="classpuntoexe_1_1imebra_1_1data_collection_iterator.html#a3c80909070bc95735155ef830f7a3314">isValid</a>(); scanTags-&gt;incIterator())</div>
<div class="line">                {</div>
<div class="line">                        <span class="keywordflow">if</span>(!newGroup-&gt;getDataType(scanTags-&gt;getId()).empty())</div>
<div class="line">                        {</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                        <a name="_a6"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;data&gt;</a> sourceTag(scanTags-&gt;getData());</div>
<div class="line">                        <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;data&gt;</a> destTag(newGroup-&gt;getTag(scanTags-&gt;getId(), <span class="keyword">true</span>));</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">for</span>(<a class="code" href="group__group__baseclasses.html#ga9ce1fe0d4177b2548a8de48901fa038f">imbxUint32</a> itemId(0); ; ++itemId)</div>
<div class="line">                        {</div>
<div class="line">                                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataSet&gt;</a> sourceSequenceItem(sourceTag-&gt;getDataSet(itemId));</div>
<div class="line">                                <span class="keywordflow">if</span>(sourceSequenceItem != 0)</div>
<div class="line">                                {</div>
<div class="line">                                        <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataSet&gt;</a> destSequenceItem(<span class="keyword">new</span> <a name="_a7"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_set.html">dataSet</a>);</div>
<div class="line">                                        destTag-&gt;setDataSet(itemId, destSequenceItem);</div>
<div class="line">                                        CopyGroups(sourceSequenceItem, destSequenceItem);</div>
<div class="line">                                        <span class="keywordflow">continue</span>;</div>
<div class="line">                                }</div>
<div class="line">                                <a name="_a8"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;handlers::dataHandlerRaw&gt;</a> sourceHandler(sourceTag-&gt;getDataHandlerRaw(itemId, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">                                <span class="keywordflow">if</span>(sourceHandler == 0)</div>
<div class="line">                                {</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;handlers::dataHandlerRaw&gt;</a> destHandler(destTag-&gt;getDataHandlerRaw(itemId, <span class="keyword">true</span>, sourceHandler-&gt;getDataType()));</div>
<div class="line">                                <a class="code" href="group__group__baseclasses.html#gab7aec65f1ced9ff851c295c4795de4b8">imbxUint8</a>* pSourceBuffer(sourceHandler-&gt;getMemoryBuffer());</div>
<div class="line">                                <span class="keywordtype">size_t</span> sourceSize(sourceHandler-&gt;getMemorySize());</div>
<div class="line">                                destHandler-&gt;setSize(sourceSize);</div>
<div class="line">                                <a class="code" href="group__group__baseclasses.html#gab7aec65f1ced9ff851c295c4795de4b8">imbxUint8</a>* pDestBuffer(destHandler-&gt;getMemoryBuffer());</div>
<div class="line">                                ::memcpy(pDestBuffer, pSourceBuffer, sourceSize);</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">        std::wstring version(L<span class="stringliteral">&quot;1.0.0.1&quot;</span>);</div>
<div class="line">        std::wcout &lt;&lt; L<span class="stringliteral">&quot;changeTransferSyntax version &quot;</span> &lt;&lt; version &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">                std::string inputFileName;</div>
<div class="line">                std::string outputFileName;</div>
<div class="line">                std::wstring transferSyntax;</div>
<div class="line">                <span class="keywordflow">if</span>(argc == 4)</div>
<div class="line">                {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">wchar_t</span>* transferSyntaxAllowedValues[]=</div>
<div class="line">                        {</div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.1&quot;</span>, <span class="comment">// Explicit VR little endian</span></div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.2&quot;</span>, <span class="comment">// Explicit VR big endian</span></div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.5&quot;</span>, <span class="comment">// RLE compression</span></div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.4.50&quot;</span>, <span class="comment">// Jpeg baseline (8 bits lossy)</span></div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.4.51&quot;</span>, <span class="comment">// Jpeg extended (12 bits lossy)</span></div>
<div class="line">                                L<span class="stringliteral">&quot;1.2.840.10008.1.2.4.57&quot;</span> <span class="comment">// Jpeg lossless NH</span></div>
<div class="line">                        };</div>
<div class="line"></div>
<div class="line">                        inputFileName = argv[1];</div>
<div class="line">                        outputFileName = argv[2];</div>
<div class="line"></div>
<div class="line">                        std::istringstream convertTransferSyntax(argv[3]);</div>
<div class="line">                        <span class="keywordtype">int</span> transferSyntaxValue(-1);</div>
<div class="line">                        convertTransferSyntax &gt;&gt; transferSyntaxValue;</div>
<div class="line">            <span class="keywordflow">if</span>(transferSyntaxValue &gt;= 0 &amp;&amp; (<span class="keywordtype">size_t</span>)transferSyntaxValue &lt; <span class="keyword">sizeof</span>(transferSyntaxAllowedValues)/<span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>*))</div>
<div class="line">                        {</div>
<div class="line">                                transferSyntax = transferSyntaxAllowedValues[transferSyntaxValue];</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(inputFileName.empty() || outputFileName.empty() || transferSyntax.empty())</div>
<div class="line">                {</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;Usage: changeTransferSyntax inputFileName outputFileName newTransferSyntax&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;newTransferSyntax values: 0 = Explicit VR little endian&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;                          1 = Explicit VR big endian&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;                          2 = RLE compression&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;                          3 = Jpeg baseline (8 bits lossy)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;                          4 = Jpeg extended (12 bits lossy)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        std::wcout &lt;&lt; L<span class="stringliteral">&quot;                          5 = Jpeg lossless NH&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                                        <span class="keywordflow">return</span> 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;dataSet&gt;</a> loadedDataSet;</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Open the file containing the dicom dataset</span></div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;puntoexe::stream&gt;</a> inputStream(<span class="keyword">new</span> <a name="_a9"></a><a class="code" href="classpuntoexe_1_1stream.html">puntoexe::stream</a>);</div>
<div class="line">                inputStream-&gt;openFile(inputFileName, std::ios_base::in);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Connect a stream reader to the dicom stream. Several stream reader</span></div>
<div class="line">                <span class="comment">//  can share the same stream</span></div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;streamReader&gt;</a> reader(<span class="keyword">new</span> <a name="_a10"></a><a class="code" href="classpuntoexe_1_1stream_reader.html">streamReader</a>(inputStream));</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Get a codec factory and let it use the right codec to create a dataset</span></div>
<div class="line">                <span class="comment">//  from the input stream</span></div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;codecs::codecFactory&gt;</a> codecsFactory(<a name="a11"></a><a class="code" href="classpuntoexe_1_1imebra_1_1codecs_1_1codec_factory.html#accaaf7d3a7250bdf71564bbfee40b96e">codecs::codecFactory::getCodecFactory</a>());</div>
<div class="line">                loadedDataSet = codecsFactory-&gt;load(reader, 2048);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Now we create a new dataset and copy the tags and images from the loaded dataset</span></div>
<div class="line">                <a name="_a12"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;puntoexe::imebra::dataSet&gt;</a> newDataSet(<span class="keyword">new</span> <a class="code" href="classpuntoexe_1_1imebra_1_1data_set.html">puntoexe::imebra::dataSet</a>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Copy the images first</span></div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                        <a class="code" href="group__group__baseclasses.html#ga9ce1fe0d4177b2548a8de48901fa038f">imbxUint32</a> scanImages(0);</div>
<div class="line">                        <span class="keywordflow">for</span>(;;)</div>
<div class="line">                        {</div>
<div class="line">                                <a name="_a13"></a><a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;image&gt;</a> copyImage(loadedDataSet-&gt;<a name="a14"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_set.html#a67b350715dd0d0fb03922fcf89dcf8c8">getImage</a>(scanImages));</div>
<div class="line">                                newDataSet-&gt;setImage(scanImages, copyImage, transferSyntax, <a name="a15"></a><a class="code" href="classpuntoexe_1_1imebra_1_1codecs_1_1codec.html#a2049bc83bc9c0c3345206bf34d4a3be9a3b33a3c04d6b80f6af721513ff7b9d51">imebra::codecs::codec::high</a>);</div>
<div class="line">                                ++scanImages;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a name="_a16"></a><a class="code" href="classpuntoexe_1_1imebra_1_1data_set_image_doesnt_exist.html">dataSetImageDoesntExist</a>&amp;)</div>
<div class="line">                {</div>
<div class="line">                        <span class="comment">// Ignore this</span></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                CopyGroups(loadedDataSet, newDataSet);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Write dataset</span></div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;puntoexe::stream&gt;</a> outputStream(<span class="keyword">new</span> <a class="code" href="classpuntoexe_1_1stream.html">puntoexe::stream</a>);</div>
<div class="line">                outputStream-&gt;openFile(outputFileName, std::ios::out);</div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;streamWriter&gt;</a> writer(<span class="keyword">new</span> <a name="_a17"></a><a class="code" href="classpuntoexe_1_1stream_writer.html">streamWriter</a>(outputStream));</div>
<div class="line">                <a class="code" href="classpuntoexe_1_1ptr.html">ptr&lt;codecs::dicomCodec&gt;</a> writeCodec(<span class="keyword">new</span> codecs::dicomCodec);</div>
<div class="line">                writeCodec-&gt;write(writer, newDataSet);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(...)</div>
<div class="line">        {</div>
<div class="line">                std::wcout &lt;&lt; <a name="a18"></a><a class="code" href="classpuntoexe_1_1exceptions_manager.html#a4b8f7abeba44492d0cfbf5d052b31b56">exceptionsManager::getMessage</a>();</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Jan 19 2016 15:32:15 for imebra by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
